<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Movie Picker</title>
</head>
<body>
  <header>
    <h1>Movie Picker</h1>
    <h2>You answer a few simple questions and I'll pick a movie you should enjoy!</h2>
  </header>

  <main>
    <form id="movie-form">
      <div class="form-group">
        <label for="childhoodFilm">Favourite childhood film?</label>
        <input type="text" id="childhoodFilm" name="childhoodFilm" placeholder="e.g. The Dark Knight">
      </div>
      <div class="form-group">
        <label for="recommendFilm">Film you always recommend?</label>
        <input type="text" id="recommendFilm" name="recommendFilm" placeholder="e.g. The Matrix">
      </div>
      <div class="form-group">
        <label for="coolestFilm">Coolest film you've ever seen?</label>
        <input type="text" id="coolestFilm" name="coolestFilm" placeholder="e.g. Inception">
      </div>
      <button type="button" id="get-movie">Get Movie Suggestion</button>
    </form>

    <section id="result-container" style="display:none; margin-top:2rem;">
      <h3 id="movie-title"></h3>
      <img id="movie-poster" src="" alt="Movie Poster" style="max-width:300px; border-radius:8px;">
      <p id="movie-overview"></p>
    </section>
  </main>

  <footer>
    <p>© 2025 Movie Picker by Asf Ahmad</p>
  </footer>

  <script>
    // Replace with your actual TMDb API key
    const TMDB_API_KEY = 'YOUR_TMDB_KEY';
    const POSTER_BASE_URL = 'https://image.tmdb.org/t/p/w500';

    const answers = {};
    document.querySelectorAll('#movie-form input').forEach(input => {
      input.addEventListener('input', e => {
        answers[e.target.name] = e.target.value.trim();
      });
    });

    document.getElementById('get-movie').addEventListener('click', async () => {
      // Basic algorithm: prefer "recommendFilm", fallback to others randomly
      const prefs = [answers.recommendFilm, answers.childhoodFilm, answers.coolestFilm].filter(Boolean);
      const query = prefs.length ? prefs[Math.floor(Math.random() * prefs.length)] : '';
      if (!query) {
        alert('Please answer at least one question!');
        return;
      }

      const url = new URL('https://api.themoviedb.org/3/search/movie');
      url.search = new URLSearchParams({
        api_key: TMDB_API_KEY,
        query: query
      });

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (!data.results.length) {
          alert('No results found — try different answers!');
          return;
        }
        // Pick a random movie from the search results
        const pick = data.results[Math.floor(Math.random() * data.results.length)];

        // Display
        document.getElementById('movie-title').innerText = `${pick.title} (${pick.release_date?.slice(0,4) || 'n/a'})`;
        document.getElementById('movie-poster').src = pick.poster_path ? POSTER_BASE_URL + pick.poster_path : '';
        document.getElementById('movie-overview').innerText = pick.overview || '';
        document.getElementById('result-container').style.display = 'block';
      } catch (err) {
        console.error(err);
        alert('Oops! Something went wrong fetching your movie.');
      }
    });
  </script>
</body>
</html>
